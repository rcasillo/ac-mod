[HEADER]
VERSION=2

[BASIC]
; G20 wheelbase: 2851mm
WHEELBASE=2.851
; 340i xDrive weight distribution: ~52% front
CG_LOCATION=0.52
CG_HEIGHT=0.47

; G20 3 Series Suspension:
; Front: Double-joint spring strut axle (MacPherson variant)
; Rear: 5-link independent suspension
; M Sport package includes Adaptive M Suspension

[ARB]
; Anti-roll bar rates (N/m)
; These are the BASE values - adjustable via setup.ini
; M Sport suspension ARB range
FRONT=38000
REAR=21000

[FRONT]
TYPE=STRUT
BASEY=-0.13
; G20 front track: 1587mm
TRACK=1.587
ROD_LENGTH=0.115
HUB_MASS=70
RIM_OFFSET=0.030

; ARB stiffness - adjustable in setup
; Base rate defined above, setup.ini adjusts around this
ARB_RATE=38000

; Strut and wishbone geometry for anti-dive characteristics
; Configured for ~15-18% anti-dive under braking
STRUT_CAR=0.23500, 0.45000, -0.07000
STRUT_TYRE=0.12000, -0.10000, 0.00300
WBCAR_BOTTOM_FRONT=0.42000, -0.07500, 0.27000
WBCAR_BOTTOM_REAR=0.43000, -0.13000, -0.05000
WBTYRE_BOTTOM=0.12000, -0.10000, 0.00300
WBCAR_STEER=0.43500, -0.12000, 0.07000
WBTYRE_STEER=0.10000, -0.10000, 0.07000

; BMW G20 factory spec: ~1mm total toe-in front (~0.5mm per wheel)
TOE_OUT=-0.00015
; Stock M340i alignment - NOT track alignment
STATIC_CAMBER=-2.2

; Spring and damper settings - M Sport Adaptive suspension
SPRING_RATE=30000
PROGRESSIVE_SPRING_RATE=800
BUMP_STOP_RATE=60000
; Bump stop UP: 50mm for 1G braking (~57mm compression at 60% load transfer)
BUMPSTOP_UP=0.050
; Bump stop DN: 120mm rebound travel (sedan needs more droop than M2's 135mm)
BUMPSTOP_DN=0.120
PACKER_RANGE=0.180

; Damper settings - properly digressive adaptive dampers (fast = 40-50% of slow)
; Scaled from M2: M2 2500/32.7kN → M340i 2800/30kN (slightly higher for heavier car)
DAMP_BUMP=2800
DAMP_FAST_BUMP=1300
DAMP_FAST_BUMPTHRESHOLD=0.050
DAMP_REBOUND=5600
DAMP_FAST_REBOUND=2500
DAMP_FAST_REBOUNDTHRESHOLD=0.100

[REAR]
TYPE=DWB
BASEY=-0.125
; G20 rear track: 1602mm
TRACK=1.602
ROD_LENGTH=0.085
HUB_MASS=75
RIM_OFFSET=0.038

; ARB stiffness - adjustable in setup
ARB_RATE=21000

; 5-link rear suspension geometry
; Provides good anti-squat under acceleration
WBCAR_TOP_FRONT=0.35500, 0.05500, 0.18500
WBCAR_TOP_REAR=0.41500, 0.08000, -0.02800
WBCAR_BOTTOM_FRONT=0.40000, -0.10500, 0.24500
WBCAR_BOTTOM_REAR=0.55000, -0.11500, -0.15500
WBTYRE_TOP=0.13000, 0.09000, 0.03700
WBTYRE_BOTTOM=0.13500, -0.13000, -0.01600
WBCAR_STEER=0.52000, -0.04500, -0.20500
WBTYRE_STEER=0.14000, -0.05200, -0.17000

; BMW G20 xDrive factory spec: ~1.5mm total toe-in rear for AWD stability
TOE_OUT=-0.00065
; Stock M340i alignment
STATIC_CAMBER=-1.0

; Rear springs - slightly softer than front for comfort
SPRING_RATE=32000
PROGRESSIVE_SPRING_RATE=0
; Rear bump stop rate: ~2x spring rate for progressive rubber stop
BUMP_STOP_RATE=65000
; Earlier engagement for better AWD squat control
BUMPSTOP_UP=0.060
; Slight increase for sedan compliance
BUMPSTOP_DN=0.100
PACKER_RANGE=0.150

; Rear damping - properly digressive (fast = 44-48% of slow)
; Scaled from M2: M2 2200/37kN → M340i 2400/32kN
DAMP_BUMP=2400
DAMP_FAST_BUMP=1150
DAMP_FAST_BUMPTHRESHOLD=0.050
DAMP_REBOUND=4800
DAMP_FAST_REBOUND=2100
DAMP_FAST_REBOUNDTHRESHOLD=0.100

[GRAPHICS_OFFSETS]
WHEEL_LF=-0.0
SUSP_LF=-0.0
WHEEL_RF=0.0
SUSP_RF=0.0
WHEEL_LR=-0.0
SUSP_LR=-0.0
WHEEL_RR=0.0
SUSP_RR=0.0

[DAMAGE]
MIN_VELOCITY=40
GAIN=0.0004
MAX_DAMAGE=0.05
DEBUG_LOG=0
